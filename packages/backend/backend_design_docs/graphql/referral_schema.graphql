# GraphQL schema for referral-related operations
# Accessed via AWS AppSync. Clients authenticate with a Cognito JWT
# sent in the Authorization header.

enum ReferralStatus {
  IN_PROGRESS
  IN_REVIEW
  PAID
  REJECTED
}

type Referral {
  id: ID!
  userId: ID!
  companyId: ID!
  clientName: String!
  status: ReferralStatus!
  amount: Float
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type Payment {
  id: ID!
  referralId: ID!
  userId: ID!
  amount: Float!
  date: AWSDateTime!
  status: String!
}

"""Aggregated metrics displayed on the user dashboard."""
type DashboardSummary {
  totalEarnings: Float!
  pendingCommissions: Float!
  totalReferrals: Int!
  successRate: Float!
}

"""Enhanced dashboard metrics with additional analytics."""
type DashboardMetrics {
  totalEarnings: Float!
  pendingCommissions: Int!
  totalReferrals: Int!
  successRate: Float!
}

type MonthlyEarning {
  month: String!
  earnings: Float!
}

type Query {
  referrals: [Referral!]!
  referral(id: ID!): Referral
  payments: [Payment!]!
  dashboardMetrics: DashboardMetrics!
  earningsByMonth(months: Int!): [MonthlyEarning!]!
}

input CreateReferralInput {
  companyId: ID!
  clientName: String!
}

input UpdateReferralStatusInput {
  id: ID!
  status: ReferralStatus!
}

type Mutation {
  createReferral(input: CreateReferralInput!): Referral!
  updateReferralStatus(input: UpdateReferralStatusInput!): Referral!
}
